version: '3.8'

services:
  bot-local:
    build: .
    container_name: mks-bot-local
    environment:
      - TG_ENV=local
    env_file:
      - core/.env.local
    volumes:
      - ./core/src:/app/core/src:ro
      - ./core/logs:/app/core/logs
    command: bun run --watch src/index.ts
    working_dir: /app/core

  bot-staging:
    build: .
    container_name: mks-bot-staging
    environment:
      - TG_ENV=staging
    env_file:
      - core/.env.staging
    ports:
      - "3001:3000"
    restart: on-failure

  bot-production:
    build: .
    container_name: mks-bot-prod
    environment:
      - TG_ENV=production
    env_file:
      - core/.env.production
    ports:
      - "3000:3000"
    restart: unless-stopped
